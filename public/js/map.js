var Game = (function (game) {
    var tiles = [
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 383, 384, 249, 249, 249, 249, 125, 125, 125, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 383, 384, 249, 249, 249, 249, 125, 125, 125, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 383, 384, 249, 249, 249, 249, 125, 125, 125, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 383, 384, 249, 249, 249, 249, 125, 125, 125, 249, 397, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 383, 384, 249, 249, 249, 249, 125, 125, 125, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 383, 384, 383, 384, 383, 384, 383, 384, 249, 249, 249, 249, 125, 125, 125, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 383, 384, 383, 384, 383, 384, 383, 384, 249, 249, 249, 249, 125, 125, 125, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 383, 384, 383, 384, 383, 384, 383, 384, 249, 249, 249, 249, 125, 125, 125, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 125, 125, 125, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 394, 395, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 415, 416, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249],
        [249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249, 249]];
    var backgtround = [
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107],
        [107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107]];
    var _columns = tiles[0].length;
    var _rows = tiles.length;
    var _isNextPositionAvailable = null;
    var _corners = null;
    var _nextPositionRow = null;
    var _nextPositionCol = null;
    var _tileSize = 32;
    game.map = {
        columns: _columns,
        rows: _rows,
        tileSize: _tileSize,
        mapWidth: _columns * _tileSize,
        mapHeight: _rows * _tileSize,
        getTile: function (col, row, second) {
            if (second) {
                return tiles[row][col];
            } else {
                return backgtround[row][col];
            }
        },
        isNextPositionAvailable: function (tileBounds) {
            _isNextPositionAvailable = true;
            _corners = [{
                    x: tileBounds.nextX,
                    y: tileBounds.nextY
                }, {
                    x: tileBounds.nextX + tileBounds.width,
                    y: tileBounds.nextY
                }, {
                    x: tileBounds.nextX,
                    y: tileBounds.nextY + tileBounds.height
                }, {
                    x: tileBounds.nextX + tileBounds.width,
                    y: tileBounds.nextY + tileBounds.height
                }];

            _corners.some(function (corner) {
                _nextPositionRow = (corner.y % this.mapHeight) / this.tileSize | 0;
                _nextPositionCol = (corner.x % this.mapWidth) / this.tileSize | 0;
                var isOutOfBounds = corner.x < 0 || corner.x > this.mapWidth || corner.y < 0 || corner.y > this.mapHeight;
                if (isOutOfBounds || tiles[_nextPositionRow][_nextPositionCol] !== 249) {
                    _isNextPositionAvailable = false;
                    return true;
                }
            }.bind(this));

            return _isNextPositionAvailable;
        }
    };
    
    return game;
})(Game || {});


